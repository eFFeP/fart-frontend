<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home - Smart TP</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            background-image: url('sfondo01.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
    </style>
</head>
<body>
    <div class="menu-icon" onclick="toggleMenu()">â˜°</div>

    <nav class="menu" id="sideMenu">
        <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#">Profilo</a></li>
            <li><a href="admin-panel.html">Pannello Amministrativo</a></li>
            <li><a href="#" id="logout">Logout</a></li>
        </ul>
    </nav>

    <div class="container">
        <h1>Benvenuto in Smart TP</h1>
    <script>
       
               function toggleMenu() {
            const menu = document.getElementById('sideMenu');
            menu.classList.toggle('open');
        }

            // Controlla il ruolo dell'utente
            const userRole = localStorage.getItem('userRole');
            if (userRole === 'admin' || userRole === 'superadmin') {
                adminPanel.style.display = 'block';
            }

            logoutButton.addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('token');
                localStorage.removeItem('userRole');
                window.location.href = 'index.html';
            });

            // Implementazione del logout automatico
            let inactivityTimer;

            function resetInactivityTimer() {
                clearTimeout(inactivityTimer);
                inactivityTimer = setTimeout(logout, 5 * 60 * 1000); // 5 minuti
            }

             function logout() {
        localStorage.removeItem('token');
        window.location.href = 'index.html';
    }

    let inactivityTimer;

    function resetInactivityTimer() {
        clearTimeout(inactivityTimer);
        inactivityTimer = setTimeout(logout, 10 * 60 * 1000); // 10 minuti
    }

    // Resetta il timer su ogni interazione dell'utente
    ['click', 'touchstart', 'mousemove'].forEach(evt => 
        document.addEventListener(evt, resetInactivityTimer, false)
    );

    document.addEventListener('DOMContentLoaded', function() {
        // Inizializzazione della pagina
        openTab(event, 'Users');
        resetInactivityTimer();

        // Aggiungi l'event listener per il pulsante di logout
        const logoutButton = document.getElementById('logout');
        if (logoutButton) {
            logoutButton.addEventListener('click', logout);
        }
    });
    </script>
</body>
</html>
